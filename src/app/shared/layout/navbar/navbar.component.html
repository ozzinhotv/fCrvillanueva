<!-- NAVBAR fijo -->
<nav class="fixed md:top-4 inset-x-0 z-50 bg-transparent">
  <div class="group w-full max-w-7xl mx-auto px-6 lg:px-12 text-white border border-white/10
              bg-neutral-900/30 backdrop-blur-md shadow-lg shadow-black/10 md:rounded-xl relative">

    <!-- fila superior -->
    <div class="py-3 flex items-center justify-between">
      <!-- LOGO -->
      <a routerLink="/" class="flex items-center gap-3 focus:outline-none focus-visible:ring-2 focus-visible:ring-red-600 rounded-lg">
        <img src="assets/img/shared/navbar/logoblack.jpg.gif" alt="Fundación Villanueva"
             class="h-10 w-auto transition-transform duration-200 ease-out group-hover:scale-[1.03] origin-left" />
        <span class="sr-only">Inicio</span>
      </a>

      <!-- LINKS DESKTOP -->
      <ul class="hidden md:flex items-center gap-8">
        <!-- Vida -->
        <li>
          <a routerLink="/vida"
             [class.text-red-500]="isSectionActive('vida')"
             class="hover:text-red-500 transition-colors">Vida</a>
        </li>

        <!-- Obra -->
        <li class="relative">
          <a routerLink="/obra"
             [class.text-red-500]="isSectionActive('obra')"
             class="inline-flex items-center gap-1 hover:text-red-500 transition-colors">
            Obra
            <svg class="h-4 w-4 transition-transform duration-150 group-hover:rotate-180"
                 viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd"
                d="M5.23 7.21a.75.75 0 011.06.02L10 11.19l3.71-3.96a.75.75 0 011.08 1.04l-4.24 4.52a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/>
            </svg>
          </a>
        </li>

        <!-- Archivo -->
        <li>
          <a [routerLink]="['/archivo']"
             [queryParams]="{ cat: 'todos' }"
             [class.text-red-500]="isSectionActive('archivo')"
             class="hover:text-red-500 transition-colors">Archivo</a>
        </li>
      </ul>

      <!-- BOTÓN MÓVIL -->
      <button type="button"
              class="md:hidden -m-2 p-2 rounded-lg inline-flex items-center gap-2 hover:text-red-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-red-600"
              aria-label="Abrir menú"
              [attr.aria-expanded]="isOpen()"
              (click)="toggle()">
        <svg *ngIf="!isOpen()" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-width="1.5" d="M4 7h16M4 12h16M4 17h16"/>
        </svg>
        <svg *ngIf="isOpen()" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-width="1.5" d="M6 6l12 12M18 6l-12 12"/>
        </svg>
        <span class="sr-only">Abrir menú</span>
      </button>
    </div>

    <!-- PANEL EXPANDIBLE (desktop) -->
    <div class="hidden md:block overflow-hidden border-t border-white/10 max-h-0 opacity-0 -translate-y-1
                transition-all duration-200 ease-out origin-top group-hover:max-h-80 group-hover:opacity-100 group-hover:translate-y-0">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 px-2 py-3">
        <!-- Obra -->
        <div>
          <div class="px-1 text-sm font-medium text-white/80 mb-2">Obra</div>
          <ul class="flex flex-col">
            <li *ngFor="let c of obraCategories()">
              <a [routerLink]="c.path"
                 class="block rounded-md px-3 py-2 text-white/90 hover:text-white hover:bg-white/10">
                {{ c.label }}
              </a>
            </li>
          </ul>
        </div>

        <!-- Archivo -->
        <div>
          <div class="px-1 text-sm font-medium text-white/80 mb-2">Archivo</div>
          <ul class="flex flex-col">
            <li *ngFor="let a of archivoCategories">
              <a [routerLink]="['/archivo']"
                 [queryParams]="{ cat: a.key }"
                 class="block rounded-md px-3 py-2 text-white/90 hover:text-white hover:bg-white/10">
                {{ a.label }}
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <!-- /PANEL -->
  </div>
</nav>

<!-- OVERLAY MÓVIL -->
<div *ngIf="isOpen()" class="md:hidden fixed inset-0 z-40 bg-black/50" (click)="close()"></div>

<!-- SIDEBAR MÓVIL -->
<aside class="md:hidden fixed inset-y-0 right-0 z-[60] w-72 text-white bg-neutral-900/85 backdrop-blur-lg
              border-l border-white/10 shadow-2xl shadow-black/40 transform transition-transform duration-200 will-change-transform p-4"
       [ngClass]="isOpen() ? 'translate-x-0' : 'translate-x-full'"
       (click)="$event.stopPropagation()">

  <div class="flex items-center justify-between mb-3 pb-3 border-b border-white/10">
    <span class="font-semibold">Menú</span>
    <button type="button" class="rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-white/60 hover:bg-white/10"
            aria-label="Cerrar menú" (click)="close()">
      <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-width="1.5" d="M6 6l12 12M18 6l-12 12"/>
      </svg>
    </button>
  </div>

  <nav class="space-y-1">
    <a routerLink="/vida" class="block rounded-lg px-3 py-2 text-white/95 hover:text-white hover:bg-white/10" (click)="close()">Vida</a>

    <!-- Obra -->
    <div>
      <a routerLink="/obra" class="block rounded-lg px-3 py-2 text-white/95 hover:text-white hover:bg-white/10" (click)="close()">Obra</a>
      <ul class="mt-1 space-y-1 px-2">
        <li *ngFor="let c of obraCategories()">
          <a [routerLink]="c.path" class="block rounded-md px-3 py-2 text-white/90 hover:text-white hover:bg-white/10" (click)="close()">
            {{ c.label }}
          </a>
        </li>
      </ul>
    </div>

    <!-- Archivo -->
    <div>
      <a [routerLink]="['/archivo']" [queryParams]="{ cat: 'todos' }"
         class="block rounded-lg px-3 py-2 text-white/95 hover:text-white hover:bg-white/10" (click)="close()">Archivo</a>
      <ul class="mt-1 space-y-1 px-2">
        <li *ngFor="let a of archivoCategories">
          <a [routerLink]="['/archivo']" [queryParams]="{ cat: a.key }"
             class="block rounded-md px-3 py-2 text-white/90 hover:text-white hover:bg-white/10" (click)="close()">
            {{ a.label }}
          </a>
        </li>
      </ul>
    </div>
  </nav>
</aside>
